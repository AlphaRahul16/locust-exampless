from locust import Locust, TaskSet, task, HttpLocust
from faker import Faker
import urllib.request as ur
fake = Faker()

class MyTaskSet(TaskSet):

    @task
    def task1(self):
        randnum = fake.ean8()
        Lname = fake.name()
        Fname = fake.company()
        date = "2020-04-08"
        ApptTime = date
        ro = "RO-{}".format(randnum)
        Status = "READYFORPICKUP"
        Email = "rahulyadav16jan@gmail.com"
        Phone1 = "9257264358"
        amount = "5.00"
        CustKey = "Cust{}".format(randnum)
        VehKey = "veh{}".format(randnum)
        dmsid = "DDF"
        ApptKey = "Apt{}".format(randnum)
        vin = ur.urlopen("http://randomvin.com/getvin.php?type=real").read().decode('utf-8')

        headers = {
            'Content-Type': 'application/x-www-form-urlencoded'
        }

        data = f"xml=<?xml version=\"1.0\" encoding=\"UTF-8\"?> <PullAppointmentsResponse xmlns=\"http://cdx.dealerbuilt.com/Api/0.99/\">    <PullAppointmentsResult xmlns:a=\"http://schemas.datacontract.org/2004/07/DealerBuilt.BaseApi\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">       <a:Appointment>          <a:Placement>             <a:GroupId>10</a:GroupId>             <a:GroupName>Lyons/Hosmer</a:GroupName>             <a:EnvironmentId>8</a:EnvironmentId>             <a:EnvironmentType>Production</a:EnvironmentType>             <a:SourceId>3</a:SourceId>             <a:CompanyId>129</a:CompanyId>             <a:CompanyName>Hosmer Honda</a:CompanyName>             <a:StoreId>5</a:StoreId>             <a:StoreName>Hosmer Honda</a:StoreName>             <a:ServiceLocationId>502</a:ServiceLocationId>             <a:ServiceLocationName>Hosmer Honda</a:ServiceLocationName>          </a:Placement>          <a:AppointmentKey>{ApptKey}</a:AppointmentKey>          <a:Attributes xmlns:b=\"http://schemas.datacontract.org/2004/07/DealerBuilt.Models.Appointments\">             <b:AppointmentScenario>NeedRide</b:AppointmentScenario>             <b:AppointmentTime>{ApptTime}</b:AppointmentTime>             <b:Comment>Text</b:Comment>             <b:Concerns>                <b:Concern>                   <b:CustomerStatement>Customer States Perform Express Lube and Rotate Tires</b:CustomerStatement>                   <b:DepartmentDescription>Quick Lube</b:DepartmentDescription>                   <b:DepartmentId>3</b:DepartmentId>                   <b:JobCode>10K</b:JobCode>                   <b:MinutesEstimated>0</b:MinutesEstimated>                   <b:PayType>ServiceContract</b:PayType>                </b:Concern>             </b:Concerns>             <b:Created>2016-02-25T01:00:00</b:Created>             <b:Mileage>10</b:Mileage>             <b:PromisedTime>0001-01-01T00:00:00</b:PromisedTime>             <b:ServiceAdvisor xmlns:c=\"http://schemas.datacontract.org/2004/07/DealerBuilt.Models\">                <c:FactoryID />                <c:IsActive>false</c:IsActive>                <c:Number>{dmsid}</c:Number>                <c:PersonalName>                   <c:FirstName>Rishi</c:FirstName>                   <c:LastName>Roy</c:LastName>                   <c:MiddleName />                   <c:SingularName i:nil=\"true\" />                   <c:Suffix i:nil=\"true\" />                   <c:Title>None</c:Title>                </c:PersonalName>                <c:Ssn />                <c:StreetAddress>                   <c:City />                   <c:Line1>Line Testing</c:Line1>                   <c:Line2 />                   <c:State />                   <c:Zip>201301</c:Zip>                </c:StreetAddress>             </b:ServiceAdvisor>             <b:Status />             <b:StatusDescription />             <b:IsCancelled>false</b:IsCancelled>          </a:Attributes>          <a:References>             <a:AppointmentCustomer>                <a:Placement>                   <a:GroupId>10</a:GroupId>                   <a:GroupName>Lyons/Hosmer</a:GroupName>                   <a:EnvironmentId>10</a:EnvironmentId>                   <a:EnvironmentType>Testing</a:EnvironmentType>                   <a:SourceId>88</a:SourceId>                </a:Placement>                <a:Attributes xmlns:b=\"http://schemas.datacontract.org/2004/07/DealerBuilt.Models.Customers\">                   <b:AllowsEmailContact>true</b:AllowsEmailContact>                   <b:AllowsMailContact>true</b:AllowsMailContact>                   <b:AllowsPhoneContact>true</b:AllowsPhoneContact>                   <b:AllowsSmsContact>true</b:AllowsSmsContact>                   <b:Comments />                   <b:CustomerNumber />                   <b:CustomerType />                   <b:DriverLicenseNumber />                   <b:DriverLicenseState>None</b:DriverLicenseState>                   <b:Identity xmlns:c=\"http://schemas.datacontract.org/2004/07/DealerBuilt.Models\">                      <c:Address1>Indrapuram</c:Address1>                      <c:Address2>Noida</c:Address2>                      <c:BirthDate i:nil=\"true\" />                      <c:City />                      <c:Country>US</c:Country>                      <c:County />                      <c:EmailAddress>{Email}</c:EmailAddress>                      <c:PersonalName>                         <c:FirstName>{Fname}</c:FirstName>                         <c:LastName>{Lname}</c:LastName>                         <c:MiddleName>Kaarma</c:MiddleName>                         <c:SingularName i:nil=\"true\" />                         <c:Suffix i:nil=\"true\" />                         <c:Title>None</c:Title>                      </c:PersonalName>                      <c:PhoneNumbers>                         <c:PhoneNumber>                            <c:Digits>{Phone1}</c:Digits>                            <c:NumberType>Cell</c:NumberType>                         </c:PhoneNumber>                         <c:PhoneNumber>                            <c:Digits>3108170196</c:Digits>                            <c:NumberType>Home</c:NumberType>                         </c:PhoneNumber>                      </c:PhoneNumbers>                      <c:Sex>Male</c:Sex>                      <c:Ssn />                      <c:State>CA</c:State>                      <c:Zip>201309</c:Zip>                   </b:Identity>                   <b:IsMarried>false</b:IsMarried>                   <b:IsWholesale>false</b:IsWholesale>                   <b:LastContactDate i:nil=\"true\" />                   <b:ModifiedStamp>2016-02-10T10:37:54.976317</b:ModifiedStamp>                </a:Attributes>                <a:CustomerKey>{CustKey}</a:CustomerKey>             </a:AppointmentCustomer>             <a:AppointmentVehicle>                <a:Placement>                   <a:GroupId>10</a:GroupId>                   <a:GroupName>Lyons/Hosmer</a:GroupName>                   <a:EnvironmentId>10</a:EnvironmentId>                   <a:EnvironmentType>Testing</a:EnvironmentType>                   <a:SourceId>88</a:SourceId>                </a:Placement>                <a:Attributes xmlns:b=\"http://schemas.datacontract.org/2004/07/DealerBuilt.Models.Vehicles\">                   <b:BodyStyle>SEDAN 4-DR</b:BodyStyle>                   <b:CertificationNumber />                   <b:Color />                   <b:ColorCode />                   <b:CylinderCount>0</b:CylinderCount>                   <b:Engine>3.5L V6 DOHC 24V</b:Engine>                   <b:EngineSerialNumber />                   <b:FactoryExteriorColor />                   <b:FactoryTrimDesc i:nil=\"true\" />                   <b:FleetID />                   <b:FuelType>Other</b:FuelType>                   <b:IgnitionKeyNumber />                   <b:InteriorColor />                   <b:InteriorColorCode />                   <b:IsCertifiedPreOwned>false</b:IsCertifiedPreOwned>                   <b:IsNonUsMarket>false</b:IsNonUsMarket>                   <b:LicensePlateNumber>NN9948HDDDD</b:LicensePlateNumber>                   <b:Make>Nissan</b:Make>                   <b:Mileage>10</b:Mileage>                   <b:Model>Altima</b:Model>                   <b:ModelNumber />                   <b:OptionString />                   <b:SaleDate>2016-02-10T00:00:00</b:SaleDate>                   <b:SaleType />                   <b:Series />                   <b:ServiceContractCompanyName />                   <b:ServiceContractExpirationDate i:nil=\"true\" />                   <b:ServiceContractExpirationMileage>20</b:ServiceContractExpirationMileage>                   <b:ServiceContractSartDate i:nil=\"true\" />                   <b:ServiceContractStartDate i:nil=\"true\" />                   <b:ServiceContractStartMileage>0</b:ServiceContractStartMileage>                   <b:Transmission />                   <b:TransmissionDescription>Continuously Variable Transmission</b:TransmissionDescription>                   <b:TrimCode>3.5 SL</b:TrimCode>                   <b:VehicleBuildDate>0001-01-01T00:00:00</b:VehicleBuildDate>                   <b:VehicleType>Suv</b:VehicleType>                   <b:Vin>{vin}</b:Vin>                   <b:Year>2008</b:Year>                </a:Attributes>                <a:References>                   <a:Owner>                      <a:Placement>                         <a:GroupId>10</a:GroupId>                         <a:GroupName>Lyons/Hosmer</a:GroupName>                         <a:EnvironmentId>10</a:EnvironmentId>                         <a:EnvironmentType>Testing</a:EnvironmentType>                         <a:SourceId>88</a:SourceId>                      </a:Placement>                      <a:Attributes xmlns:b=\"http://schemas.datacontract.org/2004/07/DealerBuilt.Models.Customers\">                         <b:AllowsEmailContact>true</b:AllowsEmailContact>                         <b:AllowsMailContact>true</b:AllowsMailContact>                         <b:AllowsPhoneContact>true</b:AllowsPhoneContact>                         <b:AllowsSmsContact>true</b:AllowsSmsContact>                         <b:Comments />                         <b:CustomerNumber />                         <b:CustomerType />                         <b:DriverLicenseNumber />                         <b:DriverLicenseState>None</b:DriverLicenseState>                         <b:Identity xmlns:c=\"http://schemas.datacontract.org/2004/07/DealerBuilt.Models\">                            <c:Address1>Indrapuram</c:Address1>                            <c:Address2>Noida</c:Address2>                            <c:BirthDate i:nil=\"true\" />                            <c:City />                            <c:Country>US</c:Country>                            <c:County />                            <c:EmailAddress>{Email}</c:EmailAddress>                            <c:PersonalName>                               <c:FirstName>{Fname}</c:FirstName>                               <c:LastName>{Lname}</c:LastName>                               <c:MiddleName>Kaarma</c:MiddleName>                               <c:SingularName i:nil=\"true\" />                               <c:Suffix i:nil=\"true\" />                               <c:Title>None</c:Title>                            </c:PersonalName>                            <c:PhoneNumbers>                               <c:PhoneNumber>                                  <c:Digits>3109169440</c:Digits>                                  <c:NumberType>Cell</c:NumberType>                               </c:PhoneNumber>                               <c:PhoneNumber>                                  <c:Digits>3108170196</c:Digits>                                  <c:NumberType>Home</c:NumberType>                               </c:PhoneNumber>                            </c:PhoneNumbers>                            <c:Sex>Male</c:Sex>                            <c:Ssn />                            <c:State>CA</c:State>                            <c:Zip>201309</c:Zip>                         </b:Identity>                         <b:IsMarried>false</b:IsMarried>                         <b:IsWholesale>false</b:IsWholesale>                         <b:LastContactDate i:nil=\"true\" />                         <b:ModifiedStamp>2016-02-10T10:37:54.976317</b:ModifiedStamp>                      </a:Attributes>                      <a:CustomerKey>{CustKey}</a:CustomerKey>                   </a:Owner>                </a:References>                <a:VehicleKey>{VehKey}</a:VehicleKey>             </a:AppointmentVehicle>          </a:References>       </a:Appointment>    </PullAppointmentsResult> </PullAppointmentsResponse>&dealerid=43"
        response = self.client.post("/lyadapter/pushrotoqueue", data=data, headers=headers)
        print(
            'Response {} \nFirstName : {} \nLastName : {} \nAppTime : {} \nRO : {} \nCustomerKey : {} \nVIN : {} \nAppKey : {} \nVehicleKey : {}'.format(
                response, Fname, Lname, ApptTime, ro, CustKey, vin, ApptKey, VehKey))


class MyLocust(HttpLocust):
    task_set = MyTaskSet
    min_wait = 2000
    max_wait = 5000